<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Công Cụ Tài Xỉu - Trang Chủ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #00ff9d;
            --secondary-color: #007bff;
            --accent-color: #ff00aa;
            --dark-bg: #121212;
            --darker-bg: #0a0a0a;
            --text-color: #ffffff;
            --panel-bg: rgba(30, 30, 30, 0.85);
            --glass-effect: rgba(255, 255, 255, 0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') no-repeat center center;
            background-size: cover;
            z-index: -2;
            filter: blur(8px) brightness(0.7);
        }
        
        body::after {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(0, 50, 50, 0.8) 100%);
            z-index: -1;
        }
        
        /* Disable right click and devtools */
        body {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .login-box {
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            transform-style: preserve-3d;
            transform: perspective(1000px);
            transition: all 0.5s ease;
        }
        
        .login-box:hover {
            transform: perspective(1000px) rotateY(5deg) rotateX(5deg);
            box-shadow: 0 15px 35px rgba(0, 255, 157, 0.3);
        }
        
        .login-title {
            font-size: 28px;
            margin-bottom: 30px;
            color: var(--primary-color);
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.5);
        }
        
        .login-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            background-color: var(--darker-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .login-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .login-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            background-color: #00e68a;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }
        
        .login-btn:active {
            transform: translateY(0);
        }
        
        .mission-container {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        
        .mission-text {
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .mission-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .mission-btn:hover {
            background-color: #e6009e;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 0, 170, 0.3);
        }
        
        .check-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .check-btn:hover {
            background-color: #0069d9;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
        }
        
        /* Main App */
        .app-container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #000;
        }
        
        .user-balance {
            background-color: var(--darker-bg);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            border: 1px solid var(--primary-color);
        }
        
        .logout-btn {
            background-color: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            background-color: var(--primary-color);
            color: #000;
        }
        
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 24px;
            cursor: pointer;
        }
        
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 20px;
            transition: all 0.3s ease;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.5);
            overflow-y: auto;
        }
        
        .sidebar.open {
            left: 0;
        }
        
        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-title {
            font-size: 20px;
            color: var(--primary-color);
        }
        
        .close-sidebar {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .sidebar-menu li {
            margin-bottom: 10px;
        }
        
        .sidebar-menu a {
            display: block;
            padding: 12px 15px;
            color: var(--text-color);
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .sidebar-menu a:hover {
            background-color: rgba(0, 255, 157, 0.1);
            color: var(--primary-color);
        }
        
        .sidebar-menu a.active {
            background-color: var(--primary-color);
            color: #000;
        }
        
        .admin-only {
            display: none;
        }
        
        .admin-mode .admin-only {
            display: block;
        }
        
        .tool-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .tool-btn {
            padding: 12px 25px;
            background-color: var(--darker-bg);
            border: 1px solid var(--primary-color);
            color: var(--text-color);
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .tool-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 157, 0.2), transparent);
            transition: 0.5s;
        }
        
        .tool-btn:hover::before {
            left: 100%;
        }
        
        .tool-btn.active {
            background-color: var(--primary-color);
            color: #000;
        }
        
        .tool-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }
        
        .tool-container {
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
            transition: all 0.5s ease;
        }
        
        .tool-container.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tool-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        input[type="number"], input[type="text"], select {
            width: 100%;
            padding: 12px;
            background-color: var(--darker-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input[type="number"]:focus, input[type="text"]:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .submit-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
            display: block;
            margin: 0 auto;
            width: 200px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .submit-btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
        
        .submit-btn:hover {
            background-color: #00e68a;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }
        
        .result-container {
            margin-top: 30px;
            padding: 20px;
            background-color: var(--darker-bg);
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
            display: none;
            animation: slideIn 0.5s ease-in-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .result-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .prediction {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .tai {
            color: #4CAF50;
            text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
        }
        
        .xiu {
            color: #F44336;
            text-shadow: 0 0 5px rgba(244, 67, 54, 0.5);
        }
        
        .dice-probability {
            margin-top: 15px;
        }
        
        .probability-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .probability-bar {
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .probability-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 5px;
            transition: width 0.5s ease-in-out;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .action-btn {
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            position: relative;
            overflow: hidden;
        }
        
        .action-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .action-btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        .check-btn {
            background-color: #2196F3;
            color: white;
        }
        
        .history-btn {
            background-color: #673AB7;
            color: white;
        }
        
        .new-game-btn {
            background-color: #FF9800;
            color: black;
        }
        
        .back-btn {
            background-color: #9E9E9E;
            color: black;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .history-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .history-content {
            background-color: var(--darker-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            animation: modalFadeIn 0.3s ease-in-out;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }
        
        .history-title {
            font-size: 24px;
            color: var(--primary-color);
            text-align: center;
            width: 100%;
        }
        
        .close-history {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            position: absolute;
            right: 0;
            top: 0;
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .history-table th, .history-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .history-table th {
            background-color: rgba(0, 255, 157, 0.1);
            color: var(--primary-color);
            position: sticky;
            top: 0;
        }
        
        .history-table tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .correct {
            color: #4CAF50;
        }
        
        .incorrect {
            color: #F44336;
        }
        
        /* Bot Container */
        .bot-container {
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .bot-header {
            background-color: var(--darker-bg);
            padding: 15px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .bot-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            margin-right: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #000;
            overflow: hidden;
        }
        
        .bot-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .bot-name {
            font-weight: bold;
            font-size: 18px;
        }
        
        .bot-status {
            margin-left: auto;
            font-size: 12px;
            color: #00ff9d;
            display: flex;
            align-items: center;
        }
        
        .bot-status::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #00ff9d;
            margin-right: 5px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .bot-messages {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.3);
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--darker-bg);
        }
        
        .bot-messages::-webkit-scrollbar {
            width: 6px;
        }
        
        .bot-messages::-webkit-scrollbar-track {
            background: var(--darker-bg);
        }
        
        .bot-messages::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 6px;
        }
        
        .message {
            margin-bottom: 15px;
            display: flex;
            animation: messageFadeIn 0.3s ease-in-out;
        }
        
        @keyframes messageFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bot-message {
            background-color: rgba(0, 255, 157, 0.1);
            padding: 12px 18px;
            border-radius: 0 18px 18px 18px;
            max-width: 80%;
            border: 1px solid rgba(0, 255, 157, 0.2);
            position: relative;
        }
        
        .bot-message::before {
            content: '';
            position: absolute;
            top: 0;
            left: -10px;
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-right-color: rgba(0, 255, 157, 0.1);
            border-left: 0;
            margin-top: 0;
        }
        
        .user-message {
            margin-left: auto;
            background-color: rgba(0, 123, 255, 0.1);
            padding: 12px 18px;
            border-radius: 18px 0 18px 18px;
            max-width: 80%;
            border: 1px solid rgba(0, 123, 255, 0.2);
            position: relative;
        }
        
        .user-message::after {
            content: '';
            position: absolute;
            top: 0;
            right: -10px;
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-left-color: rgba(0, 123, 255, 0.1);
            border-right: 0;
            margin-top: 0;
        }
        
        .message-time {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 5px;
            text-align: right;
        }
        
        .message-input-container {
            display: flex;
            padding: 15px;
            background-color: var(--darker-bg);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .message-input {
            flex: 1;
            padding: 12px;
            background-color: var(--dark-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 16px;
        }
        
        .message-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .send-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            margin-left: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .send-btn:hover {
            background-color: #00e68a;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 20px;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
            z-index: 1001;
            animation: slideInRight 0.5s ease-in-out;
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .notification-title {
            font-size: 18px;
            color: var(--primary-color);
            font-weight: bold;
            text-align: center;
            width: 100%;
        }
        
        .close-notification {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 20px;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 15px;
        }
        
        .notification-content {
            margin-bottom: 15px;
            text-align: center;
        }
        
        .notification-footer {
            text-align: center;
        }
        
        .notification-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin: 0 5px;
        }
        
        /* Payment Modal */
        .payment-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .payment-content {
            background-color: var(--darker-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            text-align: center;
        }
        
        .payment-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .payment-info {
            background-color: var(--dark-bg);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: left;
        }
        
        .payment-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .payment-item:last-child {
            border-bottom: none;
        }
        
        .copy-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .payment-note {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 15px;
            text-align: left;
        }
        
        .close-payment {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
        }
        
        /* Music Player */
        .music-player {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 999;
        }
        
        .music-control {
            background-color: var(--primary-color);
            color: #000;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .music-control:hover {
            transform: scale(1.1);
        }
        
        .music-info {
            padding-right: 10px;
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .music-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .music-artist {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* Cursor Effects */
        .cursor-effect {
            position: fixed;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgba(0, 255, 157, 0.5);
            pointer-events: none;
            transform: translate(-50%, -50%);
            z-index: 9999;
            mix-blend-mode: screen;
            animation: cursorPulse 1.5s infinite;
            display: none;
        }
        
        @keyframes cursorPulse {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.5; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        /* Copyright */
        .copyright {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
        }
        
        /* Timer */
        .timer {
            background-color: var(--darker-bg);
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 14px;
            border: 1px solid var(--primary-color);
            margin-left: 15px;
        }
        
        /* Sicbo Board */
        .sicbo-board {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .sicbo-cell {
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            text-align: center;
            background-color: var(--darker-bg);
            transition: all 0.3s;
        }
        
        .sicbo-cell.highlight {
            background-color: rgba(0, 255, 157, 0.2);
            color: var(--primary-color);
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .sicbo-cell.tai {
            background-color: rgba(76, 175, 80, 0.2);
        }
        
        .sicbo-cell.xiu {
            background-color: rgba(244, 67, 54, 0.2);
        }
        
        .sicbo-cell.chan {
            background-color: rgba(33, 150, 243, 0.2);
        }
        
        .sicbo-cell.le {
            background-color: rgba(156, 39, 176, 0.2);
        }
        
        .sicbo-cell.bao {
            background-color: rgba(255, 152, 0, 0.2);
        }
        
        .sicbo-bet-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .sicbo-bet-btn {
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .sicbo-bet-btn:hover {
            transform: translateY(-2px);
        }
        
        .sicbo-bet-btn.tai {
            background-color: rgba(76, 175, 80, 0.3);
            color: #4CAF50;
        }
        
        .sicbo-bet-btn.xiu {
            background-color: rgba(244, 67, 54, 0.3);
            color: #F44336;
        }
        
        .sicbo-bet-btn.chan {
            background-color: rgba(33, 150, 243, 0.3);
            color: #2196F3;
        }
        
        .sicbo-bet-btn.le {
            background-color: rgba(156, 39, 176, 0.3);
            color: #9C27B0;
        }
        
        /* 68GameBai Game Frame */
        .game-frame-container {
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            height: 600px;
        }
        
        .game-frame {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .login-box {
                padding: 30px 20px;
            }
            
            .container {
                padding: 10px;
            }
            
            .tool-container {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-btn {
                width: 100%;
            }
            
            .bot-messages {
                height: 300px;
                padding: 15px;
            }
            
            .message {
                margin-bottom: 10px;
            }
            
            .bot-message, .user-message {
                padding: 10px 15px;
                max-width: 90%;
            }
            
            .history-content {
                padding: 20px;
                width: 95%;
            }
            
            .music-player {
                bottom: 10px;
                left: 10px;
                right: 10px;
                justify-content: center;
                border-radius: 30px;
            }
            
            .music-info {
                display: none;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .user-info span {
                display: none;
            }
            
            .sicbo-board {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .game-frame-container {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- Cursor Effect -->
    <div class="cursor-effect" id="cursor-effect"></div>
    
    <!-- Login Container -->
    <div class="login-container" id="login-container">
        <div class="login-box">
            <h1 class="login-title">ĐĂNG NHẬP CÔNG CỤ</h1>
            <input type="text" class="login-input" id="login-username" placeholder="Tên đăng nhập">
            <input type="password" class="login-input" id="login-password" placeholder="Mật khẩu">
            <button class="login-btn" id="login-btn">ĐĂNG NHẬP</button>
            
            <div class="mission-container" id="mission-container">
                <p class="mission-text">Vui lòng làm nhiệm vụ để vào tool</p>
                <button class="mission-btn" id="mission-btn">NHẬN NHIỆM VỤ</button>
                <button class="check-btn" id="check-mission-btn">CHECK HOÀN THÀNH</button>
            </div>
        </div>
    </div>
    
    <!-- Main App Container -->
    <div class="app-container" id="app-container">
        <div class="header">
            <button class="menu-toggle" id="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <a href="#" class="logo">
                <i class="fas fa-dice"></i> TAI XIU TOOL
            </a>
            
            <div class="user-info">
                <div class="user-avatar" id="user-avatar">U</div>
                <span id="username-display">User</span>
                <div class="user-balance" id="user-balance">0 VNĐ</div>
                <div class="timer" id="tool-timer" style="display: none;">03:00:00</div>
                <button class="logout-btn" id="logout-btn">ĐĂNG XUẤT</button>
            </div>
        </div>
        
        <!-- Sidebar Menu -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">MENU</h2>
                <button class="close-sidebar" id="close-sidebar">&times;</button>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" data-section="home"><i class="fas fa-home"></i> Trang Chủ</a></li>
                <li><a href="#" data-section="toolv1"><i class="fas fa-calculator"></i> Tool V1</a></li>
                <li><a href="#" data-section="toolv2"><i class="fas fa-robot"></i> Tool V2</a></li>
                <li><a href="#" data-section="tool68"><i class="fas fa-gamepad"></i> 68GameBai Tool</a></li>
                <li><a href="#" data-section="sicbo"><i class="fas fa-chart-bar"></i> Sicbo Analyzer</a></li>
                <li class="admin-only"><a href="#" data-section="admin"><i class="fas fa-user-shield"></i> Quản trị</a></li>
                <li><a href="#" data-section="payment"><i class="fas fa-money-bill-wave"></i> Nạp Tiền</a></li>
                <li><a href="#" data-section="history"><i class="fas fa-history"></i> Lịch Sử Giao Dịch</a></li>
                <li><a href="#" id="logout-sidebar-btn"><i class="fas fa-sign-out-alt"></i> Đăng Xuất</a></li>
            </ul>
        </div>
        
        <!-- Tool Selector -->
        <div class="tool-selector">
            <button class="tool-btn active" data-tool="toolv1">Tool V1</button>
            <button class="tool-btn" data-tool="toolv2">Tool V2</button>
            <button class="tool-btn" data-tool="tool68">68GameBai Tool</button>
            <button class="tool-btn" data-tool="sicbo">Sicbo Analyzer</button>
        </div>
        
        <!-- Tool V1 Container -->
        <div class="tool-container active" id="toolv1">
            <h2 class="tool-title">CÔNG CỤ PHÂN TÍCH TÀI XỈU</h2>
            
            <div class="input-group">
                <label for="dice1">Xí ngầu 1 (1-6):</label>
                <input type="number" id="dice1" min="1" max="6" placeholder="Nhập số xí ngầu 1">
            </div>
            
            <div class="input-group">
                <label for="dice2">Xí ngầu 2 (1-6):</label>
                <input type="number" id="dice2" min="1" max="6" placeholder="Nhập số xí ngầu 2">
            </div>
            
            <div class="input-group">
                <label for="dice3">Xí ngầu 3 (1-6):</label>
                <input type="number" id="dice3" min="1" max="6" placeholder="Nhập số xí ngầu 3">
            </div>
            
            <button class="submit-btn" id="analyze-btn">PHÂN TÍCH KẾT QUẢ</button>
            
            <div class="result-container" id="result-v1">
                <h3 class="result-title">KẾT QUẢ PHÂN TÍCH</h3>
                <p class="prediction" id="prediction-text"></p>
                <p id="position-prediction"></p>
                <p id="win-rate"></p>
                <p id="analysis-reason"></p>
                <p id="bet-suggestion"></p>
                
                <div class="dice-probability">
                    <h4>Dự đoán xí ngầu ván tiếp theo:</h4>
                    <div id="next-dice-prob">
                        <div class="probability-item">
                            <span>Xí ngầu dự đoán:</span>
                            <span id="next-dice-value">-</span>
                        </div>
                        <div class="probability-bar">
                            <div class="probability-fill" id="next-dice-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn check-btn" id="check-result-btn">Check Kết Quả</button>
                    <button class="action-btn history-btn" id="history-btn">Lịch Sử</button>
                    <button class="action-btn new-game-btn" id="new-game-btn">Ván Mới</button>
                </div>
            </div>
        </div>
        
        <!-- Tool V2 Container -->
        <div class="tool-container" id="toolv2">
            <h2 class="tool-title">BOT TÀI XỈU TỰ ĐỘNG</h2>
            
            <div class="bot-container">
                <div class="bot-header">
                    <div class="bot-avatar">
                        <img src="https://media.istockphoto.com/id/1445426863/vector/chat-bot-vector-logo-design-concept.jpg?s=612x612&w=0&k=20&c=XDdfzS4lNW9yxQ0BQGZq9KMLL4bJ8ywXlYdAhBSuoCA=" alt="Bot Avatar">
                    </div>
                    <div class="bot-name">TaiXiu Analyzer</div>
                    <div class="bot-status">Đang hoạt động</div>
                </div>
                
                <div class="bot-messages" id="bot-messages">
                    <div class="message">
                        <div class="bot-message">
                            Xin chào! Tôi là bot phân tích Tài Xỉu. Vui lòng nhập 3 số xúc xắc vừa ra trong game để tôi phân tích.
                            <div class="message-time">Bây giờ</div>
                        </div>
                    </div>
                </div>
                
                <div class="message-input-container">
                    <input type="text" class="message-input" id="user-message" placeholder="Nhập 3 số xúc xắc (ví dụ: 2 4 6)">
                    <button class="send-btn" id="send-btn">Gửi</button>
                    <button class="history-btn" id="bot-history-btn" style="margin-left: 10px;">Lịch Sử</button>
                </div>
            </div>
        </div>
        
        <!-- 68GameBai Tool Container -->
        <div class="tool-container" id="tool68">
            <h2 class="tool-title">68GAMEBAI TOOL</h2>
            
            <div class="input-group">
                <label>Chọn chế độ:</label>
                <select id="game-tool-select">
                    <option value="chatbot">Bot Chat</option>
                    <option value="gamebot">Truy cập Game</option>
                </select>
            </div>
            
            <div id="chatbot-section">
                <div class="input-group">
                    <label>Chọn công cụ:</label>
                    <select id="chatbot-mode">
                        <option value="analyze">Phân tích kết quả</option>
                        <option value="predict">Dự đoán ván tiếp</option>
                    </select>
                </div>
                
                <button class="submit-btn" id="start-chatbot-btn">BẮT ĐẦU BOT CHAT</button>
                
                <div class="bot-container" id="chatbot-container" style="display: none; margin-top: 20px;">
                    <div class="bot-header">
                        <div class="bot-avatar">
                            <img src="https://cdn-icons-png.flaticon.com/512/4712/4712035.png" alt="Chat Bot Avatar">
                        </div>
                        <div class="bot-name">68GameBai Chat Bot</div>
                        <div class="bot-status">Đang kết nối API...</div>
                    </div>
                    
                    <div class="bot-messages" id="chatbot-messages">
                        <div class="message">
                            <div class="bot-message">
                                Đang kết nối đến API 68GameBai... Vui lòng chờ.
                                <div class="message-time">Bây giờ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="message-input-container">
                        <input type="text" class="message-input" id="chatbot-input" placeholder="Nhập lệnh hoặc số xúc xắc...">
                        <button class="send-btn" id="chatbot-send-btn">Gửi</button>
                    </div>
                </div>
            </div>
            
            <div id="gamebot-section" style="display: none;">
                <div class="input-group">
                    <label>Chọn game:</label>
                    <select id="game-select">
                        <option value="taixiu">Tài Xỉu</option>
                        <option value="sicbo">Sicbo</option>
                        <option value="baccarat">Baccarat</option>
                    </select>
                </div>
                
                <button class="submit-btn" id="start-gamebot-btn">TRUY CẬP GAME</button>
                
                <div class="game-frame-container" id="game-frame-container" style="display: none;">
                    <iframe src="" class="game-frame" id="game-frame"></iframe>
                </div>
            </div>
        </div>
        
        <!-- Sicbo Analyzer Container -->
        <div class="tool-container" id="sicbo">
            <h2 class="tool-title">SICBO ANALYZER</h2>
            
            <div class="input-group">
                <label for="sicbo-dice1">Xí ngầu 1 (1-6):</label>
                <input type="number" id="sicbo-dice1" min="1" max="6" placeholder="Nhập số xí ngầu 1">
            </div>
            
            <div class="input-group">
                <label for="sicbo-dice2">Xí ngầu 2 (1-6):</label>
                <input type="number" id="sicbo-dice2" min="1" max="6" placeholder="Nhập số xí ngầu 2">
            </div>
            
            <div class="input-group">
                <label for="sicbo-dice3">Xí ngầu 3 (1-6):</label>
                <input type="number" id="sicbo-dice3" min="1" max="6" placeholder="Nhập số xí ngầu 3">
            </div>
            
            <button class="submit-btn" id="analyze-sicbo-btn">PHÂN TÍCH SICBO</button>
            
            <div class="result-container" id="result-sicbo" style="display: none;">
                <h3 class="result-title">KẾT QUẢ PHÂN TÍCH SICBO</h3>
                <div class="sicbo-board" id="sicbo-board">
                    <!-- Sicbo board will be generated here -->
                </div>
                
                <div class="sicbo-bet-controls">
                    <button class="sicbo-bet-btn tai" data-bet="tai">TÀI</button>
                    <button class="sicbo-bet-btn xiu" data-bet="xiu">XỈU</button>
                    <button class="sicbo-bet-btn chan" data-bet="chan">CHẴN</button>
                    <button class="sicbo-bet-btn le" data-bet="le">LẺ</button>
                    <button class="sicbo-bet-btn bao" data-bet="bao">BÃO</button>
                </div>
                
                <div id="sicbo-analysis">
                    <p id="sicbo-prediction"></p>
                    <p id="sicbo-probability"></p>
                    <p id="sicbo-reason"></p>
                </div>
            </div>
        </div>
        
        <!-- Admin Panel Container -->
        <div class="tool-container" id="admin">
            <h2 class="tool-title">QUẢN TRỊ HỆ THỐNG</h2>
            
            <div class="input-group">
                <label>Chức năng quản trị:</label>
                <select id="admin-function">
                    <option value="users">Quản lý người dùng</option>
                    <option value="stats">Thống kê sử dụng</option>
                    <option value="settings">Cài đặt hệ thống</option>
                </select>
            </div>
            
            <div id="admin-users" class="admin-section">
                <h3>Danh sách người dùng</h3>
                <div class="user-list" id="user-list">
                    <!-- User list will be populated here -->
                </div>
            </div>
            
            <div id="admin-stats" class="admin-section" style="display: none;">
                <h3>Thống kê sử dụng</h3>
                <div class="stats-container" id="stats-container">
                    <!-- Stats will be populated here -->
                </div>
            </div>
            
            <div id="admin-settings" class="admin-section" style="display: none;">
                <h3>Cài đặt hệ thống</h3>
                <div class="settings-container" id="settings-container">
                    <!-- Settings will be populated here -->
                </div>
            </div>
        </div>
        
        <!-- Copyright -->
        <div class="copyright">
            <p>© 2023 TAI XIU TOOL | Created by <strong>@bevis1312</strong></p>
        </div>
    </div>
    
    <!-- Payment Modal -->
    <div class="payment-modal" id="payment-modal">
        <div class="payment-content">
            <h2 class="payment-title">NẠP TIỀN</h2>
            
            <div class="input-group">
                <label for="amount">Số tiền muốn nạp (VNĐ):</label>
                <input type="number" id="amount" placeholder="Nhập số tiền" min="10000" step="10000">
            </div>
            
            <div class="payment-info">
                <div class="payment-item">
                    <span>Ảnh QR:</span>
                    <img src="https://i.ibb.co/8LpJ8qfg/IMG-0814.jpg" alt="QR Code" style="width: 150px; height: 150px; border-radius: 5px;">
                </div>
                <div class="payment-item">
                    <span>Số tài khoản:</span>
                    <span>108880124782 <button class="copy-btn" data-text="108880124782"><i class="fas fa-copy"></i></button></span>
                </div>
                <div class="payment-item">
                    <span>Chủ tài khoản:</span>
                    <span>VO TIEN DAT</span>
                </div>
                <div class="payment-item">
                    <span>Nội dung chuyển tiền:</span>
                    <span id="payment-content">user100000 <button class="copy-btn" id="copy-content"><i class="fas fa-copy"></i></button></span>
                </div>
            </div>
            
            <p class="payment-note">
                <strong>Lưu ý:</strong> Sau khi chuyển tiền, vui lòng chờ 5-10 phút để hệ thống xác nhận và cập nhật số dư vào tài khoản của bạn.
            </p>
            
            <button class="close-payment" id="close-payment">ĐÓNG</button>
        </div>
    </div>
    
    <!-- History Modal -->
    <div class="history-modal" id="history-modal">
        <div class="history-content">
            <div class="history-header">
                <h3 class="history-title">LỊCH SỬ GIAO DỊCH</h3>
                <button class="close-history" id="close-history">&times;</button>
            </div>
            
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Thời gian</th>
                        <th>Loại giao dịch</th>
                        <th>Số tiền</th>
                        <th>Tool sử dụng</th>
                        <th>Trạng thái</th>
                    </tr>
                </thead>
                <tbody id="history-table-body">
                    <!-- History data will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-header">
            <h3 class="notification-title">THÔNG BÁO</h3>
            <button class="close-notification" id="close-notification">&times;</button>
        </div>
        <div class="notification-content">
            <p><strong>ADMIN TOOL:</strong> @bevis1312</p>
            <p><strong>CỔNG GAME HỖ TRỢ:</strong> ALL CỔNG GAME</p>
            <p>AE CÓ THỂ GIA NHẬP NHÓM TELE KÉO TÀI XỈU: <a href="https://t.me/keocau68gamebai_sunwin" style="color: var(--primary-color);">https://t.me/keocau68gamebai_sunwin</a></p>
            <p><strong>NOTE:</strong> WEB TOOL HOÀN TOÀN LÀ FREE, CÁC CÔNG THỨC MÌNH LÀM HOÀN TOÀN LÀ XÁC SUẤT CHÍNH XÁC 60-70%, KHÔNG PHẢI LÀ RANDOM, MÌNH KHÔNG LẤY TIỀN HAY THỜI GIAN CÔNG SỨC CỦA AE, NẾU AE THẤY TOOL DÙNG HAY, OK THÌ CÓ THỂ CHIA SẺ TỚI BẠN BÈ ĐỂ CÙNG BIẾT, VÀ AE CÓ THẮC MẮC GÌ VUI LÒNG LIÊN HỆ TELE: @BEVIS1312 NHÉ, VUI LÒNG KHÔNG DÙNG TOOL CHO CÁC HOẠT ĐỘNG BUÔN BÁN KIẾM LỜI CHO BẢN THÂN, CẢM ƠN AE ĐÃ ỦNG HỘ.</p>
        </div>
        <div class="notification-footer">
            <button class="notification-btn" id="hide-notification-btn">Ẩn trong 1 giờ</button>
            <button class="notification-btn" id="close-notification-btn">Đóng</button>
        </div>
    </div>
    
    <!-- Music Player -->
    <div class="music-player" id="music-player">
        <div class="music-control" id="play-btn">
            <i class="fas fa-play"></i>
        </div>
        <div class="music-info">
            <div class="music-title" id="music-title">Loading...</div>
            <div class="music-artist" id="music-artist">Artist</div>
        </div>
        <audio id="background-music" loop>
            <source src="https://cdn.pixabay.com/download/audio/2022/01/20/audio_dc39bbc811.mp3?filename=epic-cinematic-trailer-112623.mp3" type="audio/mpeg">
        </audio>
    </div>
    
    <script>
        // Disable right click and devtools
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            showNotification('Thông báo', 'Hành động này đã bị vô hiệu hóa', 'error');
        });
        
        // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C, Ctrl+U
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') || 
                (e.ctrlKey && e.shiftKey && e.key === 'J') || 
                (e.ctrlKey && e.shiftKey && e.key === 'C') || 
                (e.ctrlKey && e.key === 'U')) {
                e.preventDefault();
                showNotification('Thông báo', 'Hành động này đã bị vô hiệu hóa', 'error');
            }
        });
        
        // Custom cursor effect
        const cursorEffect = document.getElementById('cursor-effect');
        document.addEventListener('mousemove', (e) => {
            cursorEffect.style.display = 'block';
            cursorEffect.style.left = e.clientX + 'px';
            cursorEffect.style.top = e.clientY + 'px';
        });
        
        // Click sound effect
        const clickSound = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3');
        document.querySelectorAll('button, a, input[type="text"], input[type="number"], .tool-btn').forEach(element => {
            element.addEventListener('click', () => {
                clickSound.currentTime = 0;
                clickSound.play();
            });
        });
        
        // Hover sound effect
        const hoverSound = new Audio('https://www.soundjay.com/buttons/sounds/button-10.mp3');
        document.querySelectorAll('button, a, .tool-btn').forEach(element => {
            element.addEventListener('mouseenter', () => {
                hoverSound.currentTime = 0;
                hoverSound.play();
            });
        });
        
        // Music player
        const musicPlayer = document.getElementById('music-player');
        const playBtn = document.getElementById('play-btn');
        const backgroundMusic = document.getElementById('background-music');
        const musicTitle = document.getElementById('music-title');
        const musicArtist = document.getElementById('music-artist');
        
        // Set music info
        musicTitle.textContent = "Epic Cinematic Trailer";
        musicArtist.textContent = "Pixabay Music";
        
        playBtn.addEventListener('click', () => {
            if (backgroundMusic.paused) {
                backgroundMusic.play();
                playBtn.innerHTML = '<i class="fas fa-pause"></i>';
            } else {
                backgroundMusic.pause();
                playBtn.innerHTML = '<i class="fas fa-play"></i>';
            }
        });
        
        // Login system
        const loginContainer = document.getElementById('login-container');
        const appContainer = document.getElementById('app-container');
        const loginUsernameInput = document.getElementById('login-username');
        const loginPasswordInput = document.getElementById('login-password');
        const loginBtn = document.getElementById('login-btn');
        const missionContainer = document.getElementById('mission-container');
        const missionBtn = document.getElementById('mission-btn');
        const checkMissionBtn = document.getElementById('check-mission-btn');
        const userAvatar = document.getElementById('user-avatar');
        const usernameDisplay = document.getElementById('username-display');
        const userBalance = document.getElementById('user-balance');
        const logoutBtn = document.getElementById('logout-btn');
        const toolTimer = document.getElementById('tool-timer');
        
        // User management
        const ADMIN_USERNAME = 'leduc';
        const ADMIN_PASSWORD = 'bevis';
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('taiXiuUsers')) || {};
        let activeTool = null;
        let toolTimerInterval = null;
        
        // Initialize default user if not exists
        if (!users[ADMIN_USERNAME]) {
            users[ADMIN_USERNAME] = {
                username: ADMIN_USERNAME,
                password: ADMIN_PASSWORD,
                nickname: 'Admin',
                joinedAt: new Date().toISOString(),
                isAdmin: true,
                balance: 1000000
            };
            localStorage.setItem('taiXiuUsers', JSON.stringify(users));
        }
        
        // Initialize default regular user
        if (!users['user1']) {
            users['user1'] = {
                username: 'user1',
                password: '123456',
                nickname: 'Người dùng',
                joinedAt: new Date().toISOString(),
                isAdmin: false,
                balance: 50000
            };
            localStorage.setItem('taiXiuUsers', JSON.stringify(users));
        }
        
        // Login function
        loginBtn.addEventListener('click', () => {
            const username = loginUsernameInput.value.trim();
            const password = loginPasswordInput.value.trim();
            
            if (!username || !password) {
                showNotification('Lỗi', 'Vui lòng nhập đầy đủ thông tin', 'error');
                return;
            }
            
            // Check if user exists
            if (users[username] && users[username].password === password) {
                currentUser = users[username];
                
                if (currentUser.isAdmin) {
                    // Admin goes straight to app
                    loginSuccess();
                } else {
                    // Show mission for regular users
                    missionContainer.style.display = 'block';
                }
                
                showNotification('Thành công', 'Đăng nhập thành công', 'success');
            } else {
                showNotification('Lỗi', 'Tên đăng nhập hoặc mật khẩu không đúng', 'error');
            }
        });
        
        // Mission button
        missionBtn.addEventListener('click', () => {
            window.open('https://t.me/keocau68gamebai_sunwin', '_blank');
        });
        
        // Check mission button
        checkMissionBtn.addEventListener('click', () => {
            showNotification('Thông báo', 'Đang kiểm tra...', 'info');
            
            // Simulate checking after 5 seconds
            setTimeout(() => {
                // In a real app, you would actually check if user joined the group
                // For demo purposes, we'll assume they did
                showNotification('Thành công', 'Bạn đã hoàn thành nhiệm vụ', 'success');
                loginSuccess();
            }, 5000);
        });
        
        function loginSuccess() {
            loginContainer.style.display = 'none';
            appContainer.style.display = 'block';
            
            // Update UI
            userAvatar.textContent = currentUser.nickname.charAt(0).toUpperCase();
            usernameDisplay.textContent = currentUser.nickname;
            userBalance.textContent = currentUser.balance.toLocaleString() + ' VNĐ';
            
            // Enable admin features if admin
            if (currentUser.isAdmin) {
                document.body.classList.add('admin-mode');
            }
            
            // Show notification
            setTimeout(() => {
                showMainNotification();
            }, 1000);
        }
        
        // Logout
        logoutBtn.addEventListener('click', logout);
        document.getElementById('logout-sidebar-btn').addEventListener('click', logout);
        
        function logout() {
            currentUser = null;
            appContainer.style.display = 'none';
            loginContainer.style.display = 'flex';
            loginUsernameInput.value = '';
            loginPasswordInput.value = '';
            missionContainer.style.display = 'none';
            document.body.classList.remove('admin-mode');
            
            // Reset tool containers
            document.querySelectorAll('.tool-container').forEach(container => {
                container.style.display = 'none';
            });
            document.getElementById('toolv1').style.display = 'block';
            
            // Reset active tool button
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.tool-btn[data-tool="toolv1"]').classList.add('active');
            
            // Stop tool timer
            if (toolTimerInterval) {
                clearInterval(toolTimerInterval);
                toolTimer.style.display = 'none';
            }
        }
        
        // Sidebar menu
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');
        const closeSidebar = document.getElementById('close-sidebar');
        
        menuToggle.addEventListener('click', () => {
            sidebar.classList.add('open');
        });
        
        closeSidebar.addEventListener('click', () => {
            sidebar.classList.remove('open');
        });
        
        // Sidebar navigation
        document.querySelectorAll('.sidebar-menu a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = link.getAttribute('data-section');
                
                if (section === 'home') {
                    // Show all tools
                    document.querySelectorAll('.tool-container').forEach(container => {
                        container.style.display = 'none';
                    });
                    document.getElementById('toolv1').style.display = 'block';
                    
                    document.querySelectorAll('.tool-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    document.querySelector('.tool-btn[data-tool="toolv1"]').classList.add('active');
                } 
                else if (section === 'payment') {
                    showPaymentModal();
                }
                else if (section === 'history') {
                    showHistory();
                }
                else if (section === 'admin' && currentUser && currentUser.isAdmin) {
                    // Show admin panel
                    document.querySelectorAll('.tool-container').forEach(container => {
                        container.style.display = 'none';
                    });
                    document.getElementById(section).style.display = 'block';
                    
                    document.querySelectorAll('.tool-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Load admin data
                    loadAdminData();
                }
                else if (section !== 'logout') {
                    // Show specific tool
                    document.querySelectorAll('.tool-container').forEach(container => {
                        container.style.display = 'none';
                    });
                    document.getElementById(section).style.display = 'block';
                    
                    document.querySelectorAll('.tool-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    document.querySelector(`.tool-btn[data-tool="${section}"]`).classList.add('active');
                }
                
                sidebar.classList.remove('open');
            });
        });
        
        // Show main notification
        function showMainNotification() {
            // Check if notification was hidden
            const notificationHiddenUntil = localStorage.getItem('notificationHiddenUntil');
            if (notificationHiddenUntil && new Date(notificationHiddenUntil) > new Date()) {
                return;
            }
            
            document.getElementById('notification').style.display = 'block';
        }
        
        // Close notification
        document.getElementById('close-notification-btn').addEventListener('click', () => {
            document.getElementById('notification').style.display = 'none';
        });
        
        // Hide notification for 1 hour
        document.getElementById('hide-notification-btn').addEventListener('click', () => {
            const now = new Date();
            const hideUntil = new Date(now.getTime() + 60 * 60 * 1000); // 1 hour
            localStorage.setItem('notificationHiddenUntil', hideUntil.toISOString());
            document.getElementById('notification').style.display = 'none';
        });
        
        // Close notification with X button
        document.getElementById('close-notification').addEventListener('click', () => {
            document.getElementById('notification').style.display = 'none';
        });
        
        // Show notification function
        function showNotification(title, message, type) {
            // In a real app, you would show a proper notification
            alert(`[${title}] ${message}`);
        }
        
        // Tool selection
        const toolBtns = document.querySelectorAll('.tool-btn');
        const toolContainers = document.querySelectorAll('.tool-container');
        
        toolBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const toolId = btn.getAttribute('data-tool');
                
                // Check if user has enough balance
                if (currentUser && !currentUser.isAdmin && currentUser.balance < 10000) {
                    showNotification('Lỗi', 'Bạn không đủ tiền để sử dụng tool này. Vui lòng nạp thêm tiền.', 'error');
                    showPaymentModal();
                    return;
                }
                
                toolBtns.forEach(b => b.classList.remove('active'));
                toolContainers.forEach(c => c.classList.remove('active'));
                
                btn.classList.add('active');
                document.getElementById(toolId).classList.add('active');
                
                // Start tool timer if not admin
                if (currentUser && !currentUser.isAdmin) {
                    startToolTimer();
                    
                    // Deduct balance
                    currentUser.balance -= 10000;
                    userBalance.textContent = currentUser.balance.toLocaleString() + ' VNĐ';
                    users[currentUser.username] = currentUser;
                    localStorage.setItem('taiXiuUsers', JSON.stringify(users));
                    
                    // Add to transaction history
                    const transactions = JSON.parse(localStorage.getItem('userTransactions')) || {};
                    if (!transactions[currentUser.username]) {
                        transactions[currentUser.username] = [];
                    }
                    
                    transactions[currentUser.username].push({
                        type: 'USE_TOOL',
                        amount: -10000,
                        tool: toolId,
                        timestamp: new Date().toLocaleString(),
                        status: 'COMPLETED'
                    });
                    
                    localStorage.setItem('userTransactions', JSON.stringify(transactions));
                }
            });
        });
        
        // Start tool timer
        function startToolTimer() {
            // Clear existing timer
            if (toolTimerInterval) {
                clearInterval(toolTimerInterval);
            }
            
            let timeLeft = 3 * 60 * 60; // 3 hours in seconds
            toolTimer.style.display = 'block';
            
            function updateTimer() {
                const hours = Math.floor(timeLeft / 3600);
                const minutes = Math.floor((timeLeft % 3600) / 60);
                const seconds = timeLeft % 60;
                
                toolTimer.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(toolTimerInterval);
                    toolTimer.style.display = 'none';
                    showNotification('Hết giờ', 'Thời gian sử dụng tool của bạn đã hết. Vui lòng mua thêm thời gian.', 'info');
                } else {
                    timeLeft--;
                }
            }
            
            updateTimer();
            toolTimerInterval = setInterval(updateTimer, 1000);
        }
        
        // Tool V1 functionality
        const analyzeBtn = document.getElementById('analyze-btn');
        const resultV1 = document.getElementById('result-v1');
        const predictionText = document.getElementById('prediction-text');
        const positionPrediction = document.getElementById('position-prediction');
        const winRate = document.getElementById('win-rate');
        const analysisReason = document.getElementById('analysis-reason');
        const betSuggestion = document.getElementById('bet-suggestion');
        const checkResultBtn = document.getElementById('check-result-btn');
        const historyBtn = document.getElementById('history-btn');
        const newGameBtn = document.getElementById('new-game-btn');
        const historyModal = document.getElementById('history-modal');
        const closeHistory = document.getElementById('close-history');
        const historyTableBody = document.getElementById('history-table-body');
        const nextDiceValue = document.getElementById('next-dice-value');
        const nextDiceBar = document.getElementById('next-dice-bar');
        
        let gameHistory = JSON.parse(localStorage.getItem('taiXiuGameHistory')) || [];
        let currentPrediction = null;
        
        // Improved probability calculation with pattern recognition
        function calculateTaiXiuProbability(dice1, dice2, dice3) {
            const sum = dice1 + dice2 + dice3;
            const isTai = sum > 10;
            
            // Get recent game history
            const recentGames = gameHistory.slice(-10);
            
            // Count patterns
            let taiCount = 0;
            let xiuCount = 0;
            let samePatternCount = 0;
            
            recentGames.forEach(game => {
                if (game.prediction === 'TÀI') taiCount++;
                if (game.prediction === 'XỈU') xiuCount++;
                
                // Check for same dice pattern
                if (game.dice && game.dice.join('') === [dice1, dice2, dice3].join('')) {
                    samePatternCount++;
                }
            });
            
            // Base probability with pattern adjustment
            let baseProbability = 65; // Base 65%
            
            // Adjust based on recent patterns
            if (taiCount > 7) {
                // If last 10 games had many TAI, increase XIU probability
                baseProbability = isTai ? 55 : 75;
            } else if (xiuCount > 7) {
                // If last 10 games had many XIU, increase TAI probability
                baseProbability = isTai ? 75 : 55;
            }
            
            // Adjust for same pattern
            if (samePatternCount > 0) {
                baseProbability += samePatternCount * 5;
            }
            
            // Ensure within reasonable bounds
            return Math.max(50, Math.min(85, baseProbability));
        }
        
        // Predict next dice values based on patterns
        function predictNextDice(currentDice) {
            const [d1, d2, d3] = currentDice;
            const sum = d1 + d2 + d3;
            
            // Look for patterns in history
            let nextSum = sum;
            let probability = 65;
            
            // Check for consecutive same sums
            const lastGames = gameHistory.slice(-5);
            let sameSumCount = 0;
            
            lastGames.forEach(game => {
                if (game.dice && game.dice.reduce((a, b) => a + b, 0) === sum) {
                    sameSumCount++;
                }
            });
            
            if (sameSumCount >= 2) {
                // If same sum appears frequently, predict opposite
                nextSum = sum > 10 ? Math.floor(Math.random() * 8) + 3 : Math.floor(Math.random() * 8) + 11;
                probability = 70;
            } else {
                // Otherwise, predict similar sum with slight variation
                const variation = Math.floor(Math.random() * 5) - 2; // -2 to +2
                nextSum = Math.max(3, Math.min(18, sum + variation));
                probability = 65;
            }
            
            // Calculate individual dice values to achieve the predicted sum
            const nextD1 = Math.floor(Math.random() * 6) + 1;
            const remaining = nextSum - nextD1;
            
            if (remaining < 2 || remaining > 12) {
                // If invalid, adjust
                return predictNextDice(currentDice); // Recursive call with adjustment
            }
            
            const nextD2 = Math.floor(Math.random() * Math.min(6, remaining - 1)) + 1;
            const nextD3 = remaining - nextD2;
            
            if (nextD3 < 1 || nextD3 > 6) {
                // If invalid, adjust
                return predictNextDice(currentDice); // Recursive call with adjustment
            }
            
            return {
                values: [nextD1, nextD2, nextD3].sort((a, b) => a - b),
                probability: probability
            };
        }
        
        analyzeBtn.addEventListener('click', () => {
            const dice1 = parseInt(document.getElementById('dice1').value);
            const dice2 = parseInt(document.getElementById('dice2').value);
            const dice3 = parseInt(document.getElementById('dice3').value);
            
            if (isNaN(dice1) || isNaN(dice2) || isNaN(dice3) || 
                dice1 < 1 || dice1 > 6 || 
                dice2 < 1 || dice2 > 6 || 
                dice3 < 1 || dice3 > 6) {
                showNotification('Lỗi', 'Vui lòng nhập số xí ngầu hợp lệ (1-6)', 'error');
                return;
            }
            
            // Calculate sum
            const sum = dice1 + dice2 + dice3;
            const isTai = sum > 10;
            
            // Calculate probability with improved algorithm
            const winProbability = calculateTaiXiuProbability(dice1, dice2, dice3);
            
            // Predict next dice values
            const nextDicePrediction = predictNextDice([dice1, dice2, dice3]);
            const nextSum = nextDicePrediction.values.reduce((a, b) => a + b, 0);
            const nextIsTai = nextSum > 10;
            
            // Set prediction text
            predictionText.innerHTML = `Phiên này bạn hãy chọn: <span class="${nextIsTai ? 'tai' : 'xiu'}">${nextIsTai ? 'TÀI' : 'XỈU'}</span>`;
            positionPrediction.innerHTML = `Dự đoán vị: <span class="${nextIsTai ? 'tai' : 'xiu'}">${nextIsTai ? 'Tài' : 'Xỉu'}: ${nextDicePrediction.values.join(', ')} (Tổng: ${nextSum})</span>`;
            winRate.textContent = `Tỉ lệ thắng: ${winProbability}%`;
            
            // Analysis reason
            analysisReason.innerHTML = `
                <strong>Lý do phân tích:</strong> Dựa trên lịch sử 10 ván gần nhất, 
                ${nextIsTai ? 'Tài' : 'Xỉu'} có xác suất xuất hiện cao hơn do 
                ${winProbability > 70 ? 'xu hướng mạnh' : 'xu hướng ổn định'} trong các ván gần đây.
            `;
            
            // Bet suggestion
            if (winProbability >= 75) {
                betSuggestion.innerHTML = `<strong>Gợi ý đặt cược:</strong> Nên đặt mức cược cao (5-10% số dư)`;
            } else if (winProbability >= 65) {
                betSuggestion.innerHTML = `<strong>Gợi ý đặt cược:</strong> Nên đặt mức cược trung bình (2-5% số dư)`;
            } else {
                betSuggestion.innerHTML = `<strong>Gợi ý đặt cược:</strong> Nên đặt mức cược thấp (1-2% số dư) hoặc bỏ qua ván này`;
            }
            
            // Show next dice prediction
            nextDiceValue.textContent = nextDicePrediction.values.join(', ');
            nextDiceBar.style.width = `${nextDicePrediction.probability}%`;
            
            // Store current prediction
            currentPrediction = {
                dice: [dice1, dice2, dice3],
                prediction: nextIsTai ? 'TÀI' : 'XỈU',
                position: nextDicePrediction.values,
                winProbability,
                timestamp: new Date().toLocaleString(),
                analysis: analysisReason.innerHTML,
                suggestion: betSuggestion.innerHTML
            };
            
            // Show result
            resultV1.style.display = 'block';
        });
        
        checkResultBtn.addEventListener('click', () => {
            if (!currentPrediction) return;
            
            const result = prompt('Kết quả trong game là Tài hay Xỉu? (Nhập "tai" hoặc "xiu")');
            
            if (result && (result.toLowerCase() === 'tai' || result.toLowerCase() === 'xiu')) {
                const isCorrect = (result.toLowerCase() === 'tai' && currentPrediction.prediction === 'TÀI') || 
                                 (result.toLowerCase() === 'xiu' && currentPrediction.prediction === 'XỈU');
                
                // Add to history
                gameHistory.push({
                    ...currentPrediction,
                    actualResult: result.toUpperCase(),
                    isCorrect
                });
                
                localStorage.setItem('taiXiuGameHistory', JSON.stringify(gameHistory));
                
                showNotification('Kết quả', `${result.toUpperCase()}. Dự đoán ${isCorrect ? 'ĐÚNG' : 'SAI'}`, isCorrect ? 'success' : 'error');
            }
        });
        
        historyBtn.addEventListener('click', () => {
            renderHistory();
            historyModal.style.display = 'flex';
        });
        
        closeHistory.addEventListener('click', () => {
            historyModal.style.display = 'none';
        });
        
        newGameBtn.addEventListener('click', () => {
            document.getElementById('dice1').value = '';
            document.getElementById('dice2').value = '';
            document.getElementById('dice3').value = '';
            resultV1.style.display = 'none';
            currentPrediction = null;
        });
        
        function renderHistory() {
            historyTableBody.innerHTML = '';
            
            if (gameHistory.length === 0) {
                historyTableBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Chưa có lịch sử</td></tr>';
                return;
            }
            
            gameHistory.slice().reverse().forEach((game, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${gameHistory.length - index}</td>
                    <td>${game.prediction}</td>
                    <td>${game.actualResult || 'Chưa cập nhật'}</td>
                    <td class="${game.isCorrect ? 'correct' : 'incorrect'}">${game.isCorrect ? 'ĐÚNG' : 'SAI'}</td>
                    <td>${game.timestamp}</td>
                `;
                
                historyTableBody.appendChild(row);
            });
        }
        
        // Tool V2 functionality
        const sendBtn = document.getElementById('send-btn');
        const userMessage = document.getElementById('user-message');
        const botMessages = document.getElementById('bot-messages');
        const botHistoryBtn = document.getElementById('bot-history-btn');
        
        sendBtn.addEventListener('click', sendBotMessage);
        userMessage.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendBotMessage();
        });
        
        function sendBotMessage() {
            const text = userMessage.value.trim();
            if (!text) return;
            
            // Add user message
            addUserMessage(text);
            userMessage.value = '';
            
            // Check if message is 3 dice numbers
            const diceNumbers = text.split(' ').map(num => parseInt(num)).filter(num => !isNaN(num) && num >= 1 && num <= 6);
            
            if (diceNumbers.length === 3) {
                // Analyze the dice
                setTimeout(() => {
                    analyzeDiceForBot(diceNumbers[0], diceNumbers[1], diceNumbers[2]);
                }, 1000);
            } else {
                // Default bot response
                setTimeout(() => {
                    addBotMessage('Vui lòng nhập 3 số xúc xắc (ví dụ: 2 4 6)');
                }, 1000);
            }
        }
        
        function analyzeDiceForBot(dice1, dice2, dice3) {
            addBotMessage('Đang phân tích kết quả...');
            
            setTimeout(() => {
                const sum = dice1 + dice2 + dice3;
                
                // Calculate probability with improved algorithm
                const winProbability = calculateTaiXiuProbability(dice1, dice2, dice3);
                
                // Predict next dice values
                const nextDicePrediction = predictNextDice([dice1, dice2, dice3]);
                const nextSum = nextDicePrediction.values.reduce((a, b) => a + b, 0);
                const nextIsTai = nextSum > 10;
                
                // Send prediction
                addBotMessage(`Dự đoán: <span class="${nextIsTai ? 'tai' : 'xiu'}">${nextIsTai ? 'TÀI' : 'XỈU'}</span> (Tỉ lệ thắng: ${winProbability}%)`);
                addBotMessage(`Dự đoán vị: <span class="${nextIsTai ? 'tai' : 'xiu'}">${nextIsTai ? 'Tài' : 'Xỉu'}: ${nextDicePrediction.values.join(', ')} (Tổng: ${nextSum})</span>`);
                
                // Add analysis reason
                addBotMessage(`Lý do: Dựa trên phân tích xu hướng, ${nextIsTai ? 'Tài' : 'Xỉu'} có xác suất cao trong ván tiếp theo`);
                
                // Add bet suggestion
                if (winProbability >= 75) {
                    addBotMessage(`Gợi ý: Nên đặt cược mức cao (5-10% số dư)`);
                } else if (winProbability >= 65) {
                    addBotMessage(`Gợi ý: Nên đặt cược mức trung bình (2-5% số dư)`);
                } else {
                    addBotMessage(`Gợi ý: Nên đặt cược mức thấp (1-2% số dư) hoặc bỏ qua`);
                }
                
                // Add to history
                gameHistory.push({
                    dice: [dice1, dice2, dice3],
                    prediction: nextIsTai ? 'TÀI' : 'XỈU',
                    position: nextDicePrediction.values,
                    winProbability,
                    timestamp: new Date().toLocaleString(),
                    fromBot: true
                });
                
                localStorage.setItem('taiXiuGameHistory', JSON.stringify(gameHistory));
            }, 2000);
        }
        
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const now = new Date();
            const timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            
            messageDiv.innerHTML = `
                <div class="bot-message">
                    ${text}
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            botMessages.appendChild(messageDiv);
            botMessages.scrollTop = botMessages.scrollHeight;
        }
        
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const now = new Date();
            const timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            
            messageDiv.innerHTML = `
                <div class="user-message">
                    ${text}
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            botMessages.appendChild(messageDiv);
            botMessages.scrollTop = botMessages.scrollHeight;
        }
        
        botHistoryBtn.addEventListener('click', () => {
            renderHistory();
            historyModal.style.display = 'flex';
        });
        
        // 68GameBai Tool
        const gameToolSelect = document.getElementById('game-tool-select');
        const chatbotSection = document.getElementById('chatbot-section');
        const gamebotSection = document.getElementById('gamebot-section');
        const startChatbotBtn = document.getElementById('start-chatbot-btn');
        const startGamebotBtn = document.getElementById('start-gamebot-btn');
        const chatbotContainer = document.getElementById('chatbot-container');
        const chatbotMessages = document.getElementById('chatbot-messages');
        const chatbotInput = document.getElementById('chatbot-input');
        const chatbotSendBtn = document.getElementById('chatbot-send-btn');
        const gameFrameContainer = document.getElementById('game-frame-container');
        const gameFrame = document.getElementById('game-frame');
        
        // Toggle between chatbot and gamebot
        gameToolSelect.addEventListener('change', () => {
            if (gameToolSelect.value === 'chatbot') {
                chatbotSection.style.display = 'block';
                gamebotSection.style.display = 'none';
            } else {
                chatbotSection.style.display = 'none';
                gamebotSection.style.display = 'block';
            }
        });
        
        // Start chatbot
        startChatbotBtn.addEventListener('click', () => {
            chatbotContainer.style.display = 'block';
            addChatbotMessage('Đang kết nối đến API 68GameBai...');
            
            // Fetch data from API
            fetch68GameHistory();
        });
        
        // Fetch 68Game history from API
        async function fetch68GameHistory() {
            try {
                addChatbotMessage('Đang lấy dữ liệu từ API...');
                
                const response = await fetch('https://six8vip-okhx.onrender.com/myapi/taixiu/history');
                const data = await response.json();
                
                if (data && data.data && data.data.length > 0) {
                    const latestGame = data.data[0];
                    const dice1 = latestGame.dice1;
                    const dice2 = latestGame.dice2;
                    const dice3 = latestGame.dice3;
                    const sum = dice1 + dice2 + dice3;
                    const isTai = sum > 10;
                    
                    addChatbotMessage(`Kết quả mới nhất: ${dice1}-${dice2}-${dice3} - ${isTai ? 'TÀI' : 'XỈU'} ${sum}`);
                    
                    // Analyze the result
                    analyze68GameResult(dice1, dice2, dice3);
                } else {
                    addChatbotMessage('Không thể lấy dữ liệu từ API. Vui lòng thử lại sau.');
                }
            } catch (error) {
                addChatbotMessage('Lỗi kết nối API. Vui lòng thử lại sau.');
                console.error('API Error:', error);
            }
        }
        
        // Analyze 68Game result
        function analyze68GameResult(dice1, dice2, dice3) {
            addChatbotMessage('Đang phân tích kết quả và dự đoán ván tiếp theo...');
            
            setTimeout(() => {
                const sum = dice1 + dice2 + dice3;
                
                // Calculate probability with improved algorithm
                const winProbability = calculateTaiXiuProbability(dice1, dice2, dice3);
                
                // Predict next dice values
                const nextDicePrediction = predictNextDice([dice1, dice2, dice3]);
                const nextSum = nextDicePrediction.values.reduce((a, b) => a + b, 0);
                const nextIsTai = nextSum > 10;
                
                // Send prediction
                addChatbotMessage(`Dự đoán ván tiếp: <span class="${nextIsTai ? 'tai' : 'xiu'}">${nextIsTai ? 'TÀI' : 'XỈU'}</span> (Tỉ lệ: ${winProbability}%)`);
                addChatbotMessage(`Dự đoán xúc xắc: ${nextDicePrediction.values.join('-')} (Tổng: ${nextSum})`);
                
                // Add analysis reason
                addChatbotMessage(`Phân tích: Dựa trên xu hướng hiện tại, ${nextIsTai ? 'Tài' : 'Xỉu'} có khả năng cao xuất hiện`);
                
                // Add bet suggestion
                if (winProbability >= 75) {
                    addChatbotMessage(`Khuyến nghị: Đặt cược mức cao cho ${nextIsTai ? 'Tài' : 'Xỉu'}`);
                } else if (winProbability >= 65) {
                    addChatbotMessage(`Khuyến nghị: Đặt cược mức trung bình cho ${nextIsTai ? 'Tài' : 'Xỉu'}`);
                } else {
                    addChatbotMessage(`Khuyến nghị: Đặt cược mức thấp hoặc quan sát thêm`);
                }
            }, 2000);
        }
        
        // Start gamebot (direct game access)
        startGamebotBtn.addEventListener('click', () => {
            const gameSelect = document.getElementById('game-select').value;
            let gameUrl = 'https://68gbvn25.biz/';
            
            // Set specific game URL based on selection
            if (gameSelect === 'taixiu') {
                gameUrl += 'taixiu';
            } else if (gameSelect === 'sicbo') {
                gameUrl += 'sicbo';
            } else if (gameSelect === 'baccarat') {
                gameUrl += 'baccarat';
            }
            
            gameFrame.src = gameUrl;
            gameFrameContainer.style.display = 'block';
            
            showNotification('Thông báo', 'Đã mở game trong cửa sổ. Vui lòng đăng nhập tài khoản 68GameBai của bạn.', 'info');
        });
        
        // Chatbot message function
        function addChatbotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const now = new Date();
            const timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            
            messageDiv.innerHTML = `
                <div class="bot-message">
                    ${text}
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            chatbotMessages.appendChild(messageDiv);
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
        }
        
        // Send message in chatbot
        chatbotSendBtn.addEventListener('click', sendChatbotMessage);
        chatbotInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendChatbotMessage();
        });
        
        function sendChatbotMessage() {
            const text = chatbotInput.value.trim();
            if (!text) return;
            
            // Add user message
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const now = new Date();
            const timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            
            messageDiv.innerHTML = `
                <div class="user-message">
                    ${text}
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            chatbotMessages.appendChild(messageDiv);
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            
            chatbotInput.value = '';
            
            // Process user message
            processChatbotCommand(text);
        }
        
        // Process chatbot commands
        function processChatbotCommand(text) {
            const lowerText = text.toLowerCase();
            
            if (lowerText.includes('kết quả') || lowerText.includes('result')) {
                addChatbotMessage('Đang lấy kết quả mới nhất từ API...');
                fetch68GameHistory();
            } else if (lowerText.includes('dự đoán') || lowerText.includes('predict')) {
                addChatbotMessage('Vui lòng nhập 3 số xúc xắc gần nhất (ví dụ: 1 2 3) để phân tích');
            } else if (/\d+\s+\d+\s+\d+/.test(text)) {
                const diceNumbers = text.split(' ').map(num => parseInt(num)).filter(num => !isNaN(num) && num >= 1 && num <= 6);
                if (diceNumbers.length === 3) {
                    analyze68GameResult(diceNumbers[0], diceNumbers[1], diceNumbers[2]);
                } else {
                    addChatbotMessage('Vui lòng nhập 3 số xúc xắc hợp lệ từ 1 đến 6');
                }
            } else {
                addChatbotMessage('Tôi có thể giúp bạn phân tích kết quả Tài Xỉu. Hãy thử các lệnh như "kết quả", "dự đoán", hoặc nhập 3 số xúc xắc.');
            }
        }
        
        // Sicbo Analyzer
        const analyzeSicboBtn = document.getElementById('analyze-sicbo-btn');
        const resultSicbo = document.getElementById('result-sicbo');
        const sicboBoard = document.getElementById('sicbo-board');
        const sicboPrediction = document.getElementById('sicbo-prediction');
        const sicboProbability = document.getElementById('sicbo-probability');
        const sicboReason = document.getElementById('sicbo-reason');
        
        analyzeSicboBtn.addEventListener('click', () => {
            const dice1 = parseInt(document.getElementById('sicbo-dice1').value);
            const dice2 = parseInt(document.getElementById('sicbo-dice2').value);
            const dice3 = parseInt(document.getElementById('sicbo-dice3').value);
            
            if (isNaN(dice1) || isNaN(dice2) || isNaN(dice3) || 
                dice1 < 1 || dice1 > 6 || 
                dice2 < 1 || dice2 > 6 || 
                dice3 < 1 || dice3 > 6) {
                showNotification('Lỗi', 'Vui lòng nhập số xí ngầu hợp lệ (1-6)', 'error');
                return;
            }
            
            // Generate Sicbo board
            generateSicboBoard(dice1, dice2, dice3);
            
            // Calculate prediction
            const sum = dice1 + dice2 + dice3;
            const isTai = sum > 10;
            const isEven = sum % 2 === 0;
            const isBao = dice1 === dice2 && dice2 === dice3;
            
            // Calculate probabilities
            const taiProbability = calculateSicboProbability(sum, true);
            const xiuProbability = 100 - taiProbability;
            const evenProbability = isEven ? 55 : 45;
            const baoProbability = isBao ? 70 : 30;
            
            // Set prediction
            sicboPrediction.innerHTML = `
                <strong>Dự đoán kết quả tiếp theo:</strong><br>
                <span class="tai">TÀI: ${taiProbability}%</span> | 
                <span class="xiu">XỈU: ${xiuProbability}%</span><br>
                <span class="${isEven ? 'tai' : 'xiu'}">${isEven ? 'CHẴN' : 'LẺ'}: ${evenProbability}%</span> |
                <span class="${isBao ? 'tai' : 'xiu'}">${isBao ? 'BÃO' : 'KHÔNG BÃO'}: ${baoProbability}%</span>
            `;
            
            // Set analysis reason
            sicboReason.innerHTML = `
                <strong>Phân tích:</strong> Dựa trên kết quả hiện tại (${dice1}-${dice2}-${dice3} = ${sum}), 
                ${isTai ? 'Tài' : 'Xỉu'} có xu hướng ${taiProbability > 60 ? 'mạnh' : 'ổn định'} trong các ván tiếp theo.
                ${isBao ? 'Có khả năng xuất hiện Bão trong các ván tới.' : ''}
            `;
            
            resultSicbo.style.display = 'block';
        });
        
        // Generate Sicbo board with betting options
        function generateSicboBoard(d1, d2, d3) {
            sicboBoard.innerHTML = '';
            const sum = d1 + d2 + d3;
            const isTai = sum > 10;
            const isEven = sum % 2 === 0;
            const isBao = d1 === d2 && d2 === d3;
            
            // Create Sicbo board cells for numbers 3-18
            for (let i = 3; i <= 18; i++) {
                const cell = document.createElement('div');
                cell.className = 'sicbo-cell';
                cell.textContent = i;
                
                // Highlight the current sum
                if (i === sum) {
                    cell.classList.add('highlight');
                }
                
                // Add tai/xiu classes
                if (i > 10) {
                    cell.classList.add('tai');
                } else {
                    cell.classList.add('xiu');
                }
                
                // Add even/odd classes
                if (i % 2 === 0) {
                    cell.classList.add('chan');
                } else {
                    cell.classList.add('le');
                }
                
                sicboBoard.appendChild(cell);
            }
            
            // Add event listeners to bet buttons
            document.querySelectorAll('.sicbo-bet-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const betType = this.getAttribute('data-bet');
                    placeSicboBet(betType, sum);
                });
            });
        }
        
        // Calculate Sicbo probability
        function calculateSicboProbability(currentSum, isTai) {
            // Base probability with adjustments based on current sum
            let baseProbability = 60;
            
            if (isTai) {
                // If predicting TAI
                if (currentSum <= 8) {
                    baseProbability = 70; // More likely to change after very low sum
                } else if (currentSum >= 15) {
                    baseProbability = 50; // Less likely to stay TAI after very high sum
                }
            } else {
                // If predicting XIU
                if (currentSum <= 8) {
                    baseProbability = 50; // Less likely to stay XIU after very low sum
                } else if (currentSum >= 15) {
                    baseProbability = 70; // More likely to change after very high sum
                }
            }
            
            return baseProbability;
        }
        
        // Place Sicbo bet
        function placeSicboBet(betType, currentSum) {
            let probability;
            let betAmountSuggestion;
            
            switch(betType) {
                case 'tai':
                    probability = calculateSicboProbability(currentSum, true);
                    break;
                case 'xiu':
                    probability = calculateSicboProbability(currentSum, false);
                    break;
                case 'chan':
                    probability = currentSum % 2 === 0 ? 55 : 45;
                    break;
                case 'le':
                    probability = currentSum % 2 === 0 ? 45 : 55;
                    break;
                case 'bao':
                    probability = 30; // Lower probability for bao
                    break;
            }
            
            // Suggest bet amount based on probability
            if (probability >= 70) {
                betAmountSuggestion = '5-10% số dư';
            } else if (probability >= 60) {
                betAmountSuggestion = '3-5% số dư';
            } else {
                betAmountSuggestion = '1-2% số dư';
            }
            
            showNotification('Đặt cược Sicbo', `Bạn đã đặt cược ${betType.toUpperCase()} với xác suất thắng ${probability}%. Khuyến nghị: ${betAmountSuggestion}`, 'info');
        }
        
        // Payment system
        const paymentModal = document.getElementById('payment-modal');
        const amountInput = document.getElementById('amount');
        const paymentContent = document.getElementById('payment-content');
        const copyContentBtn = document.getElementById('copy-content');
        const closePaymentBtn = document.getElementById('close-payment');
        
        function showPaymentModal() {
            paymentModal.style.display = 'flex';
            
            // Set default amount if empty
            if (!amountInput.value) {
                amountInput.value = 100000;
            }
            
            updatePaymentContent();
        }
        
        amountInput.addEventListener('input', updatePaymentContent);
        
        function updatePaymentContent() {
            const amount = amountInput.value || 100000;
            if (currentUser) {
                paymentContent.textContent = `${currentUser.username}${amount}`;
            } else {
                paymentContent.textContent = `user${amount}`;
            }
        }
        
        copyContentBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(paymentContent.textContent);
            showNotification('Thành công', 'Đã sao chép nội dung chuyển tiền', 'success');
        });
        
        closePaymentBtn.addEventListener('click', () => {
            paymentModal.style.display = 'none';
        });
        
        // Copy buttons
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const text = btn.getAttribute('data-text');
                navigator.clipboard.writeText(text);
                showNotification('Thành công', 'Đã sao chép vào clipboard', 'success');
            });
        });
        
        // Transaction history
        function showHistory() {
            const transactions = JSON.parse(localStorage.getItem('userTransactions')) || {};
            const userTransactions = currentUser ? transactions[currentUser.username] || [] : [];
            
            historyTableBody.innerHTML = '';
            
            if (userTransactions.length === 0) {
                historyTableBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Chưa có giao dịch nào</td></tr>';
            } else {
                userTransactions.slice().reverse().forEach(transaction => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${transaction.timestamp}</td>
                        <td>${transaction.type === 'USE_TOOL' ? 'Sử dụng tool' : 'Nạp tiền'}</td>
                        <td>${transaction.amount.toLocaleString()} VNĐ</td>
                        <td>${transaction.tool || 'N/A'}</td>
                        <td>${transaction.status === 'COMPLETED' ? 'Hoàn thành' : 'Đang chờ'}</td>
                    `;
                    
                    historyTableBody.appendChild(row);
                });
            }
            
            historyModal.style.display = 'flex';
        }
        
        // Admin functions
        function loadAdminData() {
            // Load users for admin panel
            const userList = document.getElementById('user-list');
            userList.innerHTML = '';
            
            for (const username in users) {
                if (users.hasOwnProperty(username)) {
                    const user = users[username];
                    const userItem = document.createElement('div');
                    userItem.className = 'user-item';
                    userItem.innerHTML = `
                        <strong>${user.nickname}</strong> (${user.username}) - 
                        ${user.isAdmin ? 'Admin' : 'User'} - 
                        Balance: ${user.balance.toLocaleString()} VNĐ - 
                        Joined: ${new Date(user.joinedAt).toLocaleDateString()}
                    `;
                    userList.appendChild(userItem);
                }
            }
            
            // Load stats
            const statsContainer = document.getElementById('stats-container');
            statsContainer.innerHTML = `
                <p>Tổng số người dùng: ${Object.keys(users).length}</p>
                <p>Số lượng giao dịch: ${getTotalTransactions()}</p>
                <p>Doanh thu ước tính: ${calculateRevenue().toLocaleString()} VNĐ</p>
            `;
        }
        
        function getTotalTransactions() {
            const transactions = JSON.parse(localStorage.getItem('userTransactions')) || {};
            let total = 0;
            
            for (const username in transactions) {
                total += transactions[username].length;
            }
            
            return total;
        }
        
        function calculateRevenue() {
            const transactions = JSON.parse(localStorage.getItem('userTransactions')) || {};
            let revenue = 0;
            
            for (const username in transactions) {
                transactions[username].forEach(transaction => {
                    if (transaction.type === 'USE_TOOL' && transaction.amount < 0) {
                        revenue += Math.abs(transaction.amount);
                    }
                });
            }
            
            return revenue;
        }
        
        // Switch admin functions
        document.getElementById('admin-function').addEventListener('change', function() {
            document.querySelectorAll('.admin-section').forEach(section => {
                section.style.display = 'none';
            });
            
            document.getElementById('admin-' + this.value).style.display = 'block';
        });
        
        // Initialize
        if (localStorage.getItem('taiXiuGameHistory')) {
            gameHistory = JSON.parse(localStorage.getItem('taiXiuGameHistory'));
        }
        
        // Play music when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                backgroundMusic.volume = 0.3;
                backgroundMusic.play().then(() => {
                    playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                }).catch(e => {
                    console.log('Autoplay prevented:', e);
                });
            }, 1000);
        });
    </script>
</body>
</html>
